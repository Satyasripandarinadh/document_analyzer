import easyocr
import fitz  # PyMuPDF
import os

# Initialize EasyOCR reader
reader = easyocr.Reader(['en'], gpu=False)

def extract_text_from_pdf(pdf_path):
    """
    Simple OCR: Extract text from PDF using EasyOCR.
    Works on scanned or image-based PDFs.
    """
    text = ""
    
    try:
        # Open PDF
        doc = fitz.open(pdf_path)

        for page_num in range(len(doc)):
            page = doc[page_num]

            # Convert page to image
            pix = page.get_pixmap()
            img_path = f"temp_page_{page_num}.png"
            pix.save(img_path)

            # OCR the image
            result = reader.readtext(img_path, detail=0)
            page_text = "\n".join(result)
            text += page_text + "\n"

            # Remove temporary image
            os.remove(img_path)

    except Exception as e:
        print(f"Error: {e}")

    return text

